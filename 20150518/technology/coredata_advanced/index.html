<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.2 -->
    <script>
        window.materialVersion = "1.5.2"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">














    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            CoreData进阶 | 
        
        Gene&#39;s博客
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" href="/img/favicon.png">

    <meta name="format-detection" content="telephone=no"/>
    <meta name="description" itemprop="description" content="CoreData进阶">
    <meta name="keywords" content=",CoreData">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?MKetZV3cUTfDxvMffaOezg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        
            
                <style id="prettify_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_css","/css/prettify.min.css?zp8STOU9v89XWFEnN+6YmQ==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
                <style id="prettify_theme"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("prettify_theme","/css/prettify/github-v2.min.css?AfzKxt++K+/lhZBlSjnxwg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
            
        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-image: url(/img/bg.png);
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Gene&#39;s博客">
    <meta name="msapplication-starturl" content="http://chojd.com/20150518/technology/coredata_advanced/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Gene&#39;s博客">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://chojd.com/20150518/technology/coredata_advanced/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="CoreData进阶 | Gene&#39;s博客">
    <meta property="og:image" content="/img/favicon.png">
    <meta property="og:description" content="CoreData进阶">
    <meta property="og:article:tag" content="CoreData"> 

    
        <meta property="article:published_time" content="Mon May 18 2015 00:00:00 GMT+0800">
        <meta property="article:modified_time" content="Sat May 05 2018 17:01:42 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://chojd.com/20150518/technology/coredata_advanced/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "http://chojd.com/20150518/technology/coredata_advanced/index.html",
    "headline": "CoreData进阶",
    "datePublished": "Mon May 18 2015 00:00:00 GMT+0800",
    "dateModified": "Sat May 05 2018 17:01:42 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "Gene",
        "image": {
            "@type": "ImageObject",
            "url": "/img/avatar.png"
        },
        "description": "Gene Cho 的博客。,记录所学，所思，所得。"
    },
    "publisher": {
        "@type": "Organization",
        "name": "Gene&#39;s博客",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.png"
        }
    },
    "keywords": ",CoreData",
    "description": "CoreData进阶",
}
</script>


    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#CoreData进阶"><span class="post-toc-text">CoreData进阶</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x010术语"><span class="post-toc-text">0x010术语</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x011持久化存储协调器（NSPersistentStoreCoordinator）"><span class="post-toc-text">0x011持久化存储协调器（NSPersistentStoreCoordinator）</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x012托管对象模型（NSManagedObject）"><span class="post-toc-text">0x012托管对象模型（NSManagedObject）</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#0x013托管对象上下文（NSManagedObjectContext）"><span class="post-toc-text">0x013托管对象上下文（NSManagedObjectContext）</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#几个重要的概念"><span class="post-toc-text">几个重要的概念</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Entity-Attribute-Type"><span class="post-toc-text">Entity Attribute Type</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Entity-Attribute-Editor"><span class="post-toc-text">Entity Attribute Editor</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Scalar-Properties-for-Primitive-Data-Types选项"><span class="post-toc-text">Scalar Properties for Primitive Data Types选项</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#后端SQL的可见性"><span class="post-toc-text">后端SQL的可见性</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#CoreData数据迁移"><span class="post-toc-text">CoreData数据迁移</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#合并策略"><span class="post-toc-text">合并策略</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#性能优化"><span class="post-toc-text">性能优化</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#后台保存"><span class="post-toc-text">后台保存</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#用SQLDebug测量性能"><span class="post-toc-text">用SQLDebug测量性能</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#NSFetchRequest"><span class="post-toc-text">NSFetchRequest</span></a></li></ol></li></ol></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                CoreData进阶
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Gene</strong>
        <span>5月 18, 2015</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/CoreData/">CoreData</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=CoreData进阶&url=http://chojd.com/20150518/technology/coredata_advanced/index.html&pic=http://chojd.com/img/favicon.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=CoreData进阶&url=http://chojd.com/20150518/technology/coredata_advanced/index.html&via=Gene" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://chojd.com/20150518/technology/coredata_advanced/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    

    <!-- Share LinkedIn -->
    
        <a class="post_share-link" href="https://www.linkedin.com/shareArticle?mini=true&url=http://chojd.com/20150518/technology/coredata_advanced/index.html&title=CoreData进阶" target="_blank">
            <li class="mdl-menu__item">
                分享到 LinkedIn
            </li>
        </a>
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=Gene&#39;s博客&title=CoreData进阶&summary=记录所学，所思，所得。&pics=http://chojd.com/img/favicon.png&url=http://chojd.com/20150518/technology/coredata_advanced/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h1 id="CoreData进阶"><a href="#CoreData进阶" class="headerlink" title="CoreData进阶"></a>CoreData进阶</h1><h3 id="0x010术语"><a href="#0x010术语" class="headerlink" title="0x010术语"></a>0x010术语</h3><p>《此处应有三者关系图》</p>
<h3 id="0x011持久化存储协调器（NSPersistentStoreCoordinator）"><a href="#0x011持久化存储协调器（NSPersistentStoreCoordinator）" class="headerlink" title="0x011持久化存储协调器（NSPersistentStoreCoordinator）"></a>0x011持久化存储协调器（NSPersistentStoreCoordinator）</h3><p>持久化存储协调器里面包含一份持久化存储区，而存储区里面又含有数据表里的若干数据。设置持久化存储协调器的时候，通常选用SQLite数据库作为持久化存储区。（iOS只允许使用SQLite，XML atomic类型，修改数据后，要整个文件全部写入，不建议使用）</p>
<pre><code>提示：持久化存储区只应该有CoreData来创建，不应该让CoraData去使用不是由它创建的数据库。
假如需要使用既有的数据，那么应该将其导入CoreData。
</code></pre><p>同一个持久化存储协调器可以有多个持久化存储区。把CoreData与iCloud相集成的时候，就可能出现这种情况。将属于iCloud和不属于iCloud的数据分别放在不同的存储区里。及时使用多个独立的存储区，也不意味着必须使用两种对象图，在设定CoreData的模型配置选项时，可以指明对象图里面的某一部分属于哪个持久化存储区。</p>
<pre><code>注意：假如确实想使用多个持久化存储区，那么就不能为这些存储区之间的数据建立&quot;关系(Relationship)&quot;了
</code></pre><p>要想创建持久化存储区，需生成 <strong>NSPersistentStore</strong> 类的实例；想要创建持久化存储协调器，需生成 <strong>NSPersistentStoreCoordinator</strong> 类的实例</p>
<h3 id="0x012托管对象模型（NSManagedObject）"><a href="#0x012托管对象模型（NSManagedObject）" class="headerlink" title="0x012托管对象模型（NSManagedObject）"></a>0x012托管对象模型（NSManagedObject）</h3><p>托管对象模型，位于持久化存储萧条期和托管对象上下文（NSManagedObjectContext）之间.托管对象模型是描述数据结构的模型或图示（graphical representation），而托管对象正式以它为基础产生出来的。它与数据库模式（database schema）相似，有时也叫对象图。可以利用Xcode来配置实体（Entity）及实体（Entity）之间的关系。实体（Entity）类似于数据库中的数据表模式（table scheme）。实体本身并不包含数据，它们只是规定了给予该实体的托管对象应该具有何种特性，实体就相当于数据库的表，正如数据库里面的数据表有字段（field）一样，实体也有属性（attribute）。属性的数据类型可以是整数（integer），字符串（sting），日期（date）······。</p>
<h3 id="0x013托管对象上下文（NSManagedObjectContext）"><a href="#0x013托管对象上下文（NSManagedObjectContext）" class="headerlink" title="0x013托管对象上下文（NSManagedObjectContext）"></a>0x013托管对象上下文（NSManagedObjectContext）</h3><p>托管对象上下文（NSManagedObjectContext）中管理着托管对象（NSManagedObject子类对象）的生命期（lifecycle），并且负责提供许多强大的功能，，诸如faulting、变更追踪（change tracking）、验证（validations）等。</p>
<ol>
<li>所谓faulting，意思就是用户从持久化存储区中获取数据时，系统只会把需要用到的那一部分获取过来。</li>
<li>变更追踪用于支持撤销及重做功能。</li>
<li>验证机制用于确保由托管对象模型所订立的规则，比如可以针对实体的单个属性来限定其最小值或最大值等。</li>
</ol>
<p>持久化存储区可以有很多个，与之类似，托管对象上下文也可以有不止一个。有时候我们需要在后台处理任务（比如说吧数据保存到磁盘或导入数据），这种情况下可以采用多个上下文。加入在前台上下文（foreground context）上面调用save：，那么用户界面就可能会有”卡顿（lag）”现象，尤其当数据变化较大的时候，更是如此。要想避免这个问题，有个简单的办法就是指在用户按下手机Home键时才去调用save：，这时应用程序会转入后台。嗨哟与个稍微复杂但却更加灵活的办法，就是采用两个托管对象上下文。记住，托管对象上下文是存放咋高速内存里面的额，可以配置其中一个上下文，令其把数据保存到另一个上下文里。一旦把前台上下文中的数据保存到<a href="后台保存">后台上下文</a>，那么可将后台上下文中的数据异步地（asynchronously）存入磁盘。这种分段式的做法可以确保磁盘写入操作不会影响用户界面的流畅度。</p>
<blockquote>
<p>初始化NSManagedObjectContext对象，将并发类型设为NSMainQueueConcurrencyType,意思是令这个上下文(NSManagedObjectContext)在主线程队列运行。凡是编写数据驱动型的用户界面，就需要将上下文放在主线程中。</p>
</blockquote>
<pre><code>！！！注意！！！
如果某个上下文的ConcurrencyType是NSPrivateQueueConcurrencyType，
那么开发者只应该向其发送performBlock或performBlockAndWait消息。
假如不关心块何时返回，就可以使用performBlock；
假如必须等块返回之后才能往下执行，那么可以使用performBlockAndWait，那么就会令线程阻塞。
</code></pre><h2 id="几个重要的概念"><a href="#几个重要的概念" class="headerlink" title="几个重要的概念"></a>几个重要的概念</h2><h3 id="Entity-Attribute-Type"><a href="#Entity-Attribute-Type" class="headerlink" title="Entity Attribute Type"></a>Entity Attribute Type</h3><ol>
<li>Binary Data如果要保存照片，音频或有其他有“0”，“1”二进制位所组成的连续BLOB，那么可以把属性的类型设为二进制数据类型（Binary Data）。根据实体来划分NSManagedObject子类时。二进制数据这种数据类型，对于大文件来说比较合适，因为在属性的设置选项中，可以开启<strong>Allows External Storage</strong>，将其“无缝地”存储在数据库之外。启用了这个选项之后，CoreData就会自行判断是把文件存放在数据库内的效率高还是存放在数据库外的效率高。</li>
<li>Transformable 可变（Transformable）数据类型很适合用来把Objective-C对象存放到属性里。这种属性类型比较灵活，它可以存放任意类的实例。比如说，UIColor类的实例就可以保存在类型为可变类型的属性里。在根据实体来创建NSManagedObject子类时，如果实体中某个属性的类型为可变类型，那么在创建好的子类中，相关特性的类型就是id。若想把id对象放入存储区（或将其存储区里取出来），则需借助NSValueTransformer类的实例或NSValueTransformer子类的实例。NSValueTransformer类可以在属性与NSData之间“透明地”执行转换。转换过程也比较简单，尤其当待存储的类本身已经实现了NSCoding协议时更是如此。假如实现了该下一，那么系统就会提供默认的transformer，而这个transformer自己知道如何“压缩（archive）”或“解压缩（un-archive）”相关的对象。</li>
</ol>
<h3 id="Entity-Attribute-Editor"><a href="#Entity-Attribute-Editor" class="headerlink" title="Entity Attribute Editor"></a>Entity Attribute Editor</h3><ol>
<li><strong>Transient</strong> 如果在Properties中勾选了这一样，那么该特性就不会写入持久化存储区了。“不写入持久化存储区的特性”听上去有些奇怪，但有的时候，只需把特性留在托管对象上下文里面就行了，比如说，需要计算某个临时的值，而这种值就可以放在transient特性中，此特性会留在上下文里，从而能够得益于撤销或重做等功能。</li>
<li><strong>Optional</strong> optional特性并不一定要有值。所有特性在刚创建出来的时候都是optional特性。如果某特性不是optional特性，那么把这个非optional特性放回存储区的时候，它必须具备有效的值才行。</li>
<li><strong>Indexed</strong> 系统会优化Indexed特性以提升搜索效率，但代价是在底层的持久化存储区中占用额外的空间。这些额外空间的大小要根据待索引的数量来定。如果不打算搜索某个属性，那么久不要勾选Indexed，这样可以节省一些空间</li>
<li><strong>Validation</strong> 可以使用Validation中的各个选项来阻止不合理的数据进入持久化存储区。每一种数值型的属性类型都支持相同的validation（验证）选项，也就是可以规定其字符串长度或日期范围。无效的值也可以出现在托管对象上下文里面，只要在调用save:之前能把这个问题解决就行。一般来说，应该在用户试图将焦点从输入控件（比如UITextField）中移开的时候验证数据</li>
<li><strong>Reg.Ex.</strong> Reg.Ex.是Regular Expression（正则表达式）的缩写，它不仅能够限定字符串的最小长度及最大长度，而且还能实现很多验证功能。当然可以用他限定字符串的长度，但一般来说，我们会用正则表达式来判断属性中的字符串值是不是能与某个特定的模式（pattern）相匹配。如果为某个属性配置了Reg.Ex.验证功能，那么托管对象中与之对应的特性值就必须要能和给定的模式向匹配才行，否则无法将其写入持久化存储区。开发者所配置的待匹配模式必须符合<a href="userguide.icu-project.org/strings/regexp">ICU Reg Ex规范</a>。</li>
<li><strong>Default</strong> 除了可变数据类型与二进制数据之外，其余类型的属性都可以具备默认值。如果开发者不给属性指定具体的值，那么他们的初始值就是默认值。考虑到后端SQLite数据库处理null值得方式，建议给数值型的属性设定默认值。对于字符串类型的属性来说，默认值要依照具体情况来定，也就是说，得根据自己的需求来为这种属性选择适当的默认值。而对于日期类型的属性来说，开发者则无法在Model Editor中把它的默认值设为“now”(当前时间)。</li>
<li><strong>Allows External Storage</strong> 开启了该选项之后，类型为二进制数据的属性就可以把大量数据保存在持久化存储区之外了。启用之后，CoreData会自动把数据量超过1MB的属性值保存在SQLite持久化存储区之外。</li>
<li><strong>Index in Spotlight</strong> 这个选项不会影响iOS应用程序，它的用途是把基于CoreData的Mac应用程序同Spotlight继承起来。</li>
<li><strong>Store in External Record File</strong> 启用该选项之后，系统会把持久化存储区离得数据复制成XML格式，并保存在存储区之外。除非有特殊需要（比如为了调试），否则不建立开启此选项。</li>
<li><strong>Name</strong> 如果某个属性的类型是可变类型，那么名称这一栏中填写的名称将会用NSValueTransformer子类的名称，而这个子类会知道如何在任意的类与NSData之间项目转换。</li>
</ol>
<h3 id="Scalar-Properties-for-Primitive-Data-Types选项"><a href="#Scalar-Properties-for-Primitive-Data-Types选项" class="headerlink" title="Scalar Properties for Primitive Data Types选项"></a>Scalar Properties for Primitive Data Types选项</h3><p>用scalar特性来表示原始数据类型。启用了该选项之后，NSManagedObject子类只会在没有其他途径可选时，才去使用对象类型的特性。<br>实体属性和对象特性的关系表</p>
<table>
<thead>
<tr>
<th style="text-align:center">实体属性</th>
<th style="text-align:center">类里的属性特性</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Date</td>
<td style="text-align:center">NSTimeinterval</td>
</tr>
<tr>
<td style="text-align:center">Double</td>
<td style="text-align:center">double</td>
</tr>
<tr>
<td style="text-align:center">Float</td>
<td style="text-align:center">float</td>
</tr>
<tr>
<td style="text-align:center">integer16/32/64</td>
<td style="text-align:center">int16_t/int32_t/int64_t</td>
</tr>
<tr>
<td style="text-align:center">Boolean</td>
<td style="text-align:center">BOOL</td>
</tr>
</tbody>
</table>
<p>启用了选项之后，NSManagedObject子类文件会生成另一套getter方法，这样的话，在使用这些scalar值直线就无需执行unbox（数值解包）操作了。</p>
<h2 id="后端SQL的可见性"><a href="#后端SQL的可见性" class="headerlink" title="后端SQL的可见性"></a>后端SQL的可见性</h2><ol>
<li>点击Product &gt; Scheme &gt; Edit Scheme</li>
<li>点击Run  切换到Arguments分页</li>
<li>点击Arguments Passed On Launch区域中的“+”按钮，以新增参数</li>
<li>输入新参数-com.apple.CoreData.SQLDebug 3，（level 3的SQL Debug模式）点击OK按钮</li>
</ol>
<pre><code>想要查看数据库文件，需要禁用iOS7采用的“数据库日志记录模式(datebase journaling mode)”
coordinator 添加 NSDictionary *options = @{NSSQLitePragmasOption : @{@&quot;journal_mode&quot; : @&quot;DELETE&quot;}};
</code></pre><h2 id="CoreData数据迁移"><a href="#CoreData数据迁移" class="headerlink" title="CoreData数据迁移"></a>CoreData数据迁移</h2><h3 id="合并策略"><a href="#合并策略" class="headerlink" title="合并策略"></a>合并策略</h3><p>当同一个对象在两个上下文中同时被修改时，在保存其中一个上下文是，会发生合并冲突。若想处理这种合并冲突，必须预先配置合并策略。合并策略用来判定发生冲突时以哪一方的数据为准。</p>
<ol>
<li>NSErrorMergePolicy 这个是默认策略。这种合并策略将是上下文无法完成保存操作。</li>
<li>NSMergeByPropertyObjectTrumpMergePolicy 该策略解决合并冲突的办法是以上下文中对象特性值来覆写（override）持久化存储区中相对应对象的特性值。</li>
<li>NSMergeByPropertyStoreTrumpMergePolicy 该策略解决合并冲突的的办法是以持久化存储区中的对象特性值来覆写上下文中的相应的对象的特性值。</li>
<li>NSOverwriteMergePolicy 该策略解决合并冲突的办法是用上下文中的整个对象来覆写持久化存储区中的相应对象。</li>
<li>NSRollbackMergePolicy 该策略解决合并冲突的办法是用持久化存储区中的整个对象来覆写上下文中的相应对象。</li>
</ol>
<h2 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h2><h3 id="后台保存"><a href="#后台保存" class="headerlink" title="后台保存"></a><a href="id:后台保存" target="_blank" rel="noopener">后台保存</a></h3><p>想要实现后台保存功能，最简单的办法是使用两个具有上下级关系的上下文。讲后台上下文成文成为_parentContext,并将它的ConcurrencyType设为NSPrivateQueueConcurrencyType,令其使用专用队列。而用于用户加密恩的前台上下文则为_context。我们已经把它的ConcurrencyType设为NSManiQueueConcurrencyType了，所以它会使用主队列。由于这两个上下文都在内存里，所以它们之间的互相通信是非常迅速的。</p>
<p><strong>子上下文</strong>没有持久化存储区。对于子上下文来说，它的的父上下文就扮演其持久化存储区的角色。如果在字上下文上面执行保存操作，那么变更后的数据就讲保存至父上下文之中</p>
<blockquote>
<p>!!!!苹果的文档和 MagicalRecord 实现不太一样，为什么？</p>
</blockquote>
<pre><code>摘自苹果开发者文档

Using a Private Queue to Support Concurrency

In general, avoid doing data processing on the main queue that is not user-related.
Data processing can be CPU-intensive, and if it is performed on the main queue,
it can result in unresponsiveness in the user interface.
If your application will be processing data, such as importing data into Core Data from JSON,
create a private queue context and perform the import on the private context.
The following example shows how to do this:

NSArray *jsonArray = …; //JSON data to be imported into Core Data
NSManagedObjectContext *moc = …; //Our primary context on the main queue

NSManagedObjectContext *private = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
[private setParentContext:moc];

[private performBlock:^{
    for (NSDictionary *jsonObject in jsonArray) {
        NSManagedObject *mo = …; //Managed object that matches the incoming JSON structure
        //update MO with data from the dictionary
    }
    NSError *error = nil;
    if (![private save:&amp;error]) {
        NSLog(@&quot;Error saving context: %@\n%@&quot;, [error localizedDescription], [error userInfo]);
        abort();
    }
}];
</code></pre><h3 id="用SQLDebug测量性能"><a href="#用SQLDebug测量性能" class="headerlink" title="用SQLDebug测量性能"></a>用SQLDebug测量性能</h3><ol>
<li>点击Product &gt; Scheme &gt; Edit Scheme</li>
<li>点击Run  切换到Arguments分页</li>
<li>点击Arguments Passed On Launch区域中的“+”按钮，以新增参数</li>
<li>输入新参数-com.apple.CoreData.SQLDebug 1，（level 1的SQL Debug模式）点击OK按钮</li>
</ol>
<h3 id="NSFetchRequest"><a href="#NSFetchRequest" class="headerlink" title="NSFetchRequest"></a>NSFetchRequest</h3><ol>
<li>setFetchLimit 以及 setFetchOffset 可用来讲Fetch操作的结果中所包含的行数减少到某个值，并且使Fetch操作能够从某个定点开始执行。这对于使用Page视图控制器来显示信息的应用程序比较适合。每个Page的Fetch Limit可能相同，但是其Fetch Offset（执行获取的偏移量）会有所不同。</li>
<li>setPredicate 可以根据开发者所提供的谓词来减少“获取集”的大小。假如开发者提供的是“复合谓词”（compound predicate，也就是根据两个或两个以上的标准来筛选数据），那么应该把“能从结果中排除最多内容”（cut out the most results）的那个谓词放在前面。另外，把过滤数值的谓词放在过滤文本值得谓词之前，也能提升性能。</li>
<li>setPropertiesToGroupBy 与 setResultType 结合起来使用可以模拟出纯SQL的 GROUP BY 操作符。假如与setHavingPredicate结合起来，那么还可以继续限定获取到的结果。</li>
<li>setIncludesPropertyValues:NO 可是获取请求在执行的时候把特性都排除掉，如果开发者只想获取每个对象的objectID，那么可以使用该选项。</li>
<li>setRelationshipKeyPathsForPrefetching选项用来表示某些关系应该“预先获取”（pre-fetch）。pre-fetch操作会把与某关系关联的对象提前加载到上下文之中，这样就可以免去“把fault还原为托管对象”（fire the fault）这一操作，从而能够提升效率。</li>
</ol>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/20160720/life/rain/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/20150518/technology/ios_cocoapods_basic/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="Gene's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        i@chojd.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto:i@chojd.com" target="_blank" title="发邮件">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">send</i>
                        
                        发邮件
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/04/">四月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/12/">十二月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/11/">十一月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/06/">六月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/05/">五月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">三月 2017<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/09/">九月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">七月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/05/">五月 2015<span class="sidebar_archives-count">2</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/思考/">思考<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/技术/">技术<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/categories/生活/">生活<span class="sidebar_archives-count">4</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/timeline" title="时间轴">
                
                    <i class="material-icons sidebar-material-icons">timeline</i>
                
                时间轴
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/chojd" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;2015&nbsp;-<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>Gene's博客
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?V/53wGualMuiPM3xoetD5Q==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>



    
        <script>lsloader.load("sm_js","/js/smoothscroll.js?lOy/ACj5suSNi7ZVFVbpFQ==", true)</script>
    











<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->

    
        
            <script>lsloader.load("prettify_js","/js/prettify.min.js?WN07fivHQSMKWy7BmHBB6w==", true)</script>
        
    


    
        <script>lsloader.load("hanabi","/js/hanabi-browser-bundle.js?Pki5+pzkluqu53g+ouMWpA==", true)</script>
    


<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
        
            $(function() {
                $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
                prettyPrint();
                })
        
    
    
        
            HanabiBrowser.clearColors();
        
        
        HanabiBrowser.start('pre code',false);
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.2 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
